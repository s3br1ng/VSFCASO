<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü—Ä–æ—Ñ–∏–ª—å</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="nav-bar">
        <a href="orders.html" class="nav-button">–ó–∞—è–≤–∫–∏</a>
        <a href="create_order.html" class="nav-button">–ü–æ–¥–∞—Ç—å –∑–∞—è–≤–∫—É</a>
        <a href="profile_info.html" class="nav-button">–ü—Ä–æ—Ñ–∏–ª—å</a>
        <a href="technic_edit_orders.html" class="nav-button">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–∞–º–∏</a>
        <a href="admin_users.html" class="nav-button">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</a>
        <button id="theme-toggle" class="nav-button">üåû</button>
    </div>

    <div class="container-small">
        <h2>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ</h2>
        <div id="user-info"></div>
        <button onclick="logout()">–í—ã–π—Ç–∏</button>
    </div>

    <script>
        const token = localStorage.getItem('token');
        const themeToggle = document.getElementById('theme-toggle');    

        if (localStorage.getItem('theme') === 'light') {
            document.body.classList.add('light-theme');
            themeToggle.textContent = 'üåô';
        }

        themeToggle.addEventListener('click', () => {
            document.body.classList.toggle('light-theme');
            if (document.body.classList.contains('light-theme')) {
                localStorage.setItem('theme', 'light');
                themeToggle.textContent = 'üåô';
            } else {
                localStorage.setItem('theme', 'dark');
                themeToggle.textContent = 'üåû';
            }
        });

        if (!token) {
            window.location.href = 'login.html';
        }

        async function loadUserInfo() {
            try {
                const response = await fetch(`http://212.67.12.137:8000/profile?token=${token}`, {
                    method: 'GET',
                    headers: { 'Content-Type': 'application/json' }
                });

                if (response.ok) {
                    const user = await response.json();
                    document.getElementById('user-info').innerHTML = `
                    ID: ${user.id}<br>
                    –ù–∏–∫–Ω–µ–π–º: ${user.nickname}<br>
                    –†–æ–ª—å: ${user.role}<br>
                    –ò–º—è: ${user.first_name}<br>
                    –§–∞–º–∏–ª–∏—è: ${user.last_name}<br>
                    –û—Ç—á–µ—Å—Ç–≤–æ: ${user.patronymic}<br>
                    –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è: ${user.date_of_birth}<br>
                    –û—Ç–¥–µ–ª: ${user.department}<br>
                    –î–æ–ª–∂–Ω–æ—Å—Ç—å: ${user.position}
                    `;}
            } catch (err) {
                document.getElementById('user-info').textContent = '–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö.';
                console.error(err);
            }
        }


        loadUserInfo();

        function logout() {
            localStorage.removeItem('token');
            window.location.href = 'login.html';
        }
    </script>
</body>
</html>