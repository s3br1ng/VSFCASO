<!-- static/order_details.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>–î–µ—Ç–∞–ª–∏ –∑–∞—è–≤–∫–∏</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <div class="nav-bar">
        <a href="orders.html" class="nav-button">–ó–∞—è–≤–∫–∏</a>
        <a href="create_order.html" class="nav-button">–ü–æ–¥–∞—Ç—å –∑–∞—è–≤–∫—É</a>
        <a href="profile_info.html" class="nav-button">–ü—Ä–æ—Ñ–∏–ª—å</a>
        <a href="technic_edit_orders.html" class="nav-button">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–∞–º–∏</a>
        <a href="admin_users.html" class="nav-button">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</a>
        <button id="theme-toggle" class="nav-button">üåû</button>
    </div>

    <div class="container-small">
        <h2>–î–µ—Ç–∞–ª–∏ –∑–∞—è–≤–∫–∏</h2>
        <div id="order-details">

        </div>
    </div>

    <script>
        const token = localStorage.getItem('token');
        const urlParams = new URLSearchParams(window.location.search);
        const orderId = urlParams.get('id');
        const themeToggle = document.getElementById('theme-toggle');    

        if (localStorage.getItem('theme') === 'light') {
            document.body.classList.add('light-theme');
            themeToggle.textContent = 'üåô';
        }

        themeToggle.addEventListener('click', () => {
            document.body.classList.toggle('light-theme');
            if (document.body.classList.contains('light-theme')) {
                localStorage.setItem('theme', 'light');
                themeToggle.textContent = 'üåô';
            } else {
                localStorage.setItem('theme', 'dark');
                themeToggle.textContent = 'üåû';
            }
        });

        if (!token || !orderId) {
            window.location.href = 'login.html';
        }

        async function loadOrderDetails() {
            try {
                const response = await fetch(`http://212.67.12.137:8000/Orders/${orderId}?token=${token}`, {
                    method: 'GET',
                    headers: { 'Content-Type': 'application/json' }
                });

                if (!response.ok) throw new Error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö");

                const order = await response.json();

                document.getElementById('order-details').innerHTML = `
                    <p><strong>ID:</strong> ${order.id}</p>
                    <p><strong>–ù–∞–∑–≤–∞–Ω–∏–µ:</strong> ${order.name}</p>
                    <p><strong>–°—Ä–æ—á–Ω–æ—Å—Ç—å:</strong> ${order.urgent ? "–î–∞" : "–ù–µ—Ç"}</p>
                    <p><strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong> ${order.description}</p>
                    <p><strong>–°—Ç–∞—Ç—É—Å:</strong> ${order.status}</p>
                    <p><strong>–ö–ª–∏–µ–Ω—Ç:</strong> ${order.client}</p>
                    <p><strong>–ú–∞—Å—Ç–µ—Ä:</strong> ${order.master || "‚Äî"}</p>
                `;
            } catch (err) {
                alert("–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–µ—Ç–∞–ª–∏ –∑–∞—è–≤–∫–∏");
                window.location.href = 'orders.html';
            }
        }

        loadOrderDetails();
    </script>
</body>
</html>